const HandlerCommand = require("./handlercommand");
const SimpleHandlerCommand = require("./simplehandlercommand.js");

class HandlerCommandParent extends HandlerCommand {
	#subs;

	constructor(args) {
		super(args);

		this.#subs = {};
	}

	addSub(name, args, func) {
		if (this.#subs[name]) {
			return;
		}
		this.#subs[name] = new SimpleHandlerCommand(args, func);

		// Return this for easy adding of multiple subcommands
		return this;
	}

	run(interaction, opts, args) {
		let sub = this.#subs[interaction.options.getSubcommand()];
		return sub.run(interaction, opts, args);
	}

	canRun(interaction) {
		if (!super.canRun(interaction)) return false;

		// Check if we can also run the subcommand
		let sub = this.#subs[interaction.options.getSubcommand()];
		return sub.canRun(interaction);
	}

	get subcommands() {
		return this.#subs;
	}
}

module.exports = HandlerCommandParent;
